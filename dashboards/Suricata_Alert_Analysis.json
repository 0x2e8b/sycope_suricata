{"name":"Suricata Alert Analysis","type":"dashboard","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830077811,"modified":1770840040667,"dashboardConfig":{"cols":24,"gridType":"proportional","rows":18,"compactType":null,"widgetSpacing":8,"disableVisAnimations":false,"dashboardType":"standard","type":"standard","related":[],"requireFilters":{},"requireTimerange":{"maxRange":"30m"}},"items":[{"layout":{"id":"e6df5ab6-6c40-4727-9f59-cb23d82cd384","header":{"hideTitle":true},"w":6,"h":2,"x":0,"y":0,"moved":false,"static":false},"config":{"$ref":"67136ca4-d89d1b5f-28fdb93b","id":"67136ca4-d89d1b5f-28fdb93b","name":"Suricata - Critical Alerts (Sev 1)","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830074879,"modified":1770840101118,"visualizationConfig":{"type":"kpi","concreteVisualizationConfig":{"dataKey":"countCrit","dataKeys":["countCrit"],"categoryKey":"_bucket","categoryKeys":["_bucket"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[]},"names":{"metrics":[{"custom":true,"value":"Critical"}],"buckets":[]},"colors":{"metrics":[{"useCustomColor":true,"type":"single","reversePalette":false,"color":"#FF1431","useDefaultColor":false}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"dataConfigs":[{"label":"Critical","fontSize":"xl","align":"center","labelColor":{"useCustomColor":false},"iconOptions":{"icon":""}}],"type":"kpi","hideTooMuchInputData":{"active":false},"drilldown":[]}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"},"query":"event_type = \"alert\" AND alert_severity = 1","advanced":false},"outputQuery":{},"aggs":{"metrics":[{"metric":"alert_severity","metricName":"alert_severity","useAggr":true,"field":"alert_severity","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countCrit=count(alert_severity)","postAggr":""},"alias":"countCrit"}],"buckets":[]},"limit":{"active":true,"othersShow":false,"limit":1000,"from":"head"},"queries":[{"nql":"event_type = \"alert\" | alert_severity = 1 | aggr countCrit=count(alert_severity) unwind=true | limit 1000","subpipes":[]}],"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136ca4-d89d1b5f-28fdb93b","permissions":{"entityId":"67136ca4-d89d1b5f-28fdb93b","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"d52419b1-dc08-480f-a05a-30a53a903f0a","header":{"hideTitle":true},"w":6,"h":2,"x":6,"y":0,"moved":false,"static":false},"config":{"$ref":"67136ca5-d89d1b5f-28fdb93f","id":"67136ca5-d89d1b5f-28fdb93f","name":"Suricata - High Alerts (Sev 2)","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830075150,"modified":1770840082054,"visualizationConfig":{"type":"kpi","concreteVisualizationConfig":{"dataKey":"countHigh","dataKeys":["countHigh"],"categoryKey":"_bucket","categoryKeys":["_bucket"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[]},"names":{"metrics":[{"custom":true,"value":"High"}],"buckets":[]},"colors":{"metrics":[{"useCustomColor":true,"type":"single","reversePalette":false,"color":"#FF7A00","useDefaultColor":false}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"dataConfigs":[{"label":"High","fontSize":"xl","align":"center","labelColor":{"useCustomColor":false},"iconOptions":{"icon":""}}],"type":"kpi","hideTooMuchInputData":{"active":false},"drilldown":[]}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"},"query":"event_type = \"alert\" AND alert_severity = 2","advanced":false},"outputQuery":{},"aggs":{"metrics":[{"metric":"alert_severity","metricName":"alert_severity","useAggr":true,"field":"alert_severity","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countHigh=count(alert_severity)","postAggr":""},"alias":"countHigh"}],"buckets":[]},"limit":{"active":true,"othersShow":false,"limit":1000,"from":"head"},"queries":[{"nql":"event_type = \"alert\" | alert_severity = 2 | aggr countHigh=count(alert_severity) unwind=true | limit 1000","subpipes":[]}],"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136ca5-d89d1b5f-28fdb93f","permissions":{"entityId":"67136ca5-d89d1b5f-28fdb93f","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"f988b2a6-c8d0-4c59-a4a5-2bddce5b7ae4","header":{"hideTitle":true},"w":6,"h":2,"x":12,"y":0,"moved":false,"static":false},"config":{"$ref":"67136ca5-d89d1b5f-28fdb943","id":"67136ca5-d89d1b5f-28fdb943","name":"Suricata - Medium Alerts (Sev 3)","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830075391,"modified":1770840055469,"visualizationConfig":{"type":"kpi","concreteVisualizationConfig":{"dataKey":"countMed","dataKeys":["countMed"],"categoryKey":"_bucket","categoryKeys":["_bucket"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[]},"names":{"metrics":[{"custom":true,"value":"Medium"}],"buckets":[]},"colors":{"metrics":[{"useCustomColor":true,"type":"single","color":"#FFB800","reversePalette":false,"useDefaultColor":false}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"dataConfigs":[{"label":"Medium","fontSize":"xl","align":"center","labelColor":{"useCustomColor":false},"iconOptions":{"icon":""}}],"type":"kpi","hideTooMuchInputData":{"active":false},"drilldown":[]}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"},"query":"event_type = \"alert\" AND alert_severity = 3","advanced":false},"outputQuery":{},"aggs":{"metrics":[{"metric":"alert_severity","metricName":"alert_severity","useAggr":true,"field":"alert_severity","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countMed=count(alert_severity)","postAggr":""},"alias":"countMed"}],"buckets":[]},"limit":{"active":true,"othersShow":false,"limit":1000,"from":"head"},"queries":[{"nql":"event_type = \"alert\" | alert_severity = 3 | aggr countMed=count(alert_severity) unwind=true | limit 1000","subpipes":[]}],"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136ca5-d89d1b5f-28fdb943","permissions":{"entityId":"67136ca5-d89d1b5f-28fdb943","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"fb980733-c279-4b9d-ac08-28e9e6b73a9b","header":{"hideTitle":true},"w":6,"h":2,"x":18,"y":0,"moved":false,"static":false},"config":{"$ref":"67136ca5-d89d1b5f-28fdb947","id":"67136ca5-d89d1b5f-28fdb947","name":"Suricata - Low Alerts","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830075643,"modified":1770840064603,"visualizationConfig":{"type":"kpi","concreteVisualizationConfig":{"dataKey":"countLow","dataKeys":["countLow"],"categoryKey":"_bucket","categoryKeys":["_bucket"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[]},"names":{"metrics":[{"custom":true,"value":"Low"}],"buckets":[]},"colors":{"metrics":[{"useCustomColor":true,"type":"single","color":"#276EDB","reversePalette":false,"useDefaultColor":false}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"dataConfigs":[{"label":"Low","fontSize":"xl","align":"center","labelColor":{"useCustomColor":false},"iconOptions":{"icon":""}}],"type":"kpi","hideTooMuchInputData":{"active":false},"drilldown":[]}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"},"query":"event_type = \"alert\" AND alert_severity >= 4","advanced":false},"outputQuery":{},"aggs":{"metrics":[{"metric":"alert_severity","metricName":"alert_severity","useAggr":true,"field":"alert_severity","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countLow=count(alert_severity)","postAggr":""},"alias":"countLow"}],"buckets":[]},"limit":{"active":true,"othersShow":false,"limit":1000,"from":"head"},"queries":[{"nql":"event_type = \"alert\" | alert_severity >= 4 | aggr countLow=count(alert_severity) unwind=true | limit 1000","subpipes":[]}],"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136ca5-d89d1b5f-28fdb947","permissions":{"entityId":"67136ca5-d89d1b5f-28fdb947","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"90c5bf31-415f-4956-a7fb-9c620dda8132","header":null,"w":12,"h":5,"x":0,"y":2,"moved":false,"static":false},"config":{"$ref":"67136ca5-d89d1b5f-28fdb94b","id":"67136ca5-d89d1b5f-28fdb94b","name":"Suricata - Alert Volume by Severity","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830075890,"modified":1770830075890,"visualizationConfig":{"type":"chart","concreteVisualizationConfig":{"dataKey":"countAlert_severity","dataKeys":["countAlert_severity"],"categoryKey":"srcEventTimestamp","categoryKeys":["srcEventTimestamp","alert_severity"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[{"formattingType":"date","formattingPattern":"yyyy-MM-dd HH:mm"},null]},"names":{"metrics":[{"custom":false,"value":"count(alert_severity)"}],"buckets":[{"custom":false,"value":"Time"},{"custom":false,"value":"Alert Severity"}]},"colors":{"metrics":[{"useCustomColor":false,"useDefaultColor":true}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"defaultFilterStream":["suricata","suricata"],"isCategoryDate":true,"categoryDateInterval":"5m","autoBucket":true,"timeKeys":["srcEventTimestamp"],"splitKeys":["alert_severity"],"splitChartsKeys":[],"splitSeriesKeys":["alert_severity"],"joinDataCategories":["srcEventTimestamp"],"gridIndexes":[0],"markers":[{"maxMarker":{},"minMarker":{},"maxLine":{},"minLine":{},"avgLine":{}}],"stack":{"metrics":["Type"]},"valueConfigs":{"metrics":[{"showLabels":false}]},"active":{"metrics":[true]},"sort":"desc","includeTotal":{"hidden":false},"type":"bar","hideTooMuchData":{"active":true,"value":502,"message":"To protect the browser performance, a limit of output records has been imposed on the widget. Please apply filters or narrow down the analysed time frame to display the results."},"hideTooMuchInputData":{"active":false},"noData":{"active":false},"animation":true,"drilldown":[],"showLocalQuerySwitch":false,"displayValuesOnXAxis":false,"yAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":false,"snap":false,"type":"shadow"}}],"xAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":true,"snap":true,"type":"shadow"}}],"showLegend":true,"legendPosition":"top","showLegendMetricName":false,"legendIcons":"radio","showInSingleMode":false,"showSimpleChartTitle":true,"chartAreaConfig":{"active":false}}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"}},"outputQuery":{},"aggs":{"metrics":[{"metric":"alert_severity","metricName":"alert_severity","useAggr":true,"field":"alert_severity","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countAlert_severity=count(alert_severity)","postAggr":""},"alias":"countAlert_severity","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true}],"buckets":[{"aggregation":"timeAggr","bucket":"timestamp","field":"timestamp","alias":"srcEventTimestamp","preFn":"timestamp","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":true,"type":"top","limit":10,"byMetric":"","byMetricSort":"desc","byField":[],"inverted":false,"showOthers":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":false},{"aggregation":"terms","useFn":false,"bucket":"alert_severity","field":"alert_severity","alias":"alert_severity","preFn":"alert_severity","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":true,"type":"top","limit":5,"byMetric":"","byMetricSort":"desc","byField":[],"inverted":false,"showOthers":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true,"splitChart":false}]},"sorters":[],"limit":{"active":true,"limit":100,"from":"head","othersShow":false},"queries":[{"nql":"src event_type = \"alert\" | (valInColl(alert_severity, \"a2bef78c-db024cc2-a027cc7f_0_alert_severity_bucket-limit\", \"alert_severity\") OR alert_severity = null) | timeAggr countAlert_severity=count(alert_severity) on timestamp by alert_severity as alert_severity interval=\"${AUTOBUCKET_INTERVAL}\" dir=\"desc\" unwind=true bucketAlias=\"srcEventTimestamp\" | limit 100","subpipes":[{"nql":"${LIMIT_SOURCE} | src event_type = \"alert\" | neq(null, alert_severity) | aggr countAlert_severity=count(alert_severity) by alert_severity as alert_severity unwind=true | sort countAlert_severity desc | limit 5 | dst \"a2bef78c-db024cc2-a027cc7f_0_alert_severity_bucket-limit\""}]}],"includeTotal":{"hidden":false},"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136ca5-d89d1b5f-28fdb94b","permissions":{"entityId":"67136ca5-d89d1b5f-28fdb94b","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"ad9451ce-82f8-4cd4-90ad-a7a0262d625f","header":null,"w":12,"h":5,"x":12,"y":2,"moved":false,"static":false},"config":{"$ref":"67136ca6-d89d1b5f-28fdb94f","id":"67136ca6-d89d1b5f-28fdb94f","name":"Suricata - Alerts by Category Over Time","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830076141,"modified":1770830076141,"visualizationConfig":{"type":"chart","concreteVisualizationConfig":{"dataKey":"countEvent_category","dataKeys":["countEvent_category"],"categoryKey":"srcEventTimestamp","categoryKeys":["srcEventTimestamp","event_category"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[{"formattingType":"date","formattingPattern":"yyyy-MM-dd HH:mm"},null]},"names":{"metrics":[{"custom":false,"value":"count(event_category)"}],"buckets":[{"custom":false,"value":"Time"},{"custom":false,"value":"Alert Category"}]},"colors":{"metrics":[{"useCustomColor":false,"useDefaultColor":true}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"defaultFilterStream":["suricata","suricata"],"isCategoryDate":true,"categoryDateInterval":"5m","autoBucket":true,"timeKeys":["srcEventTimestamp"],"splitKeys":["event_category"],"splitChartsKeys":[],"splitSeriesKeys":["event_category"],"joinDataCategories":["srcEventTimestamp"],"gridIndexes":[0],"markers":[{"maxMarker":{},"minMarker":{},"maxLine":{},"minLine":{},"avgLine":{}}],"stack":{"metrics":[null]},"valueConfigs":{"metrics":[{"showLabels":false,"drawArea":false,"lineType":"solid","lineWidth":2}]},"active":{"metrics":[true]},"sort":"desc","includeTotal":{"hidden":false},"type":"line","hideTooMuchData":{"active":true,"value":502,"message":"To protect the browser performance, a limit of output records has been imposed on the widget. Please apply filters or narrow down the analysed time frame to display the results."},"hideTooMuchInputData":{"active":false},"noData":{"active":false},"animation":true,"drilldown":[],"showLocalQuerySwitch":false,"displayValuesOnXAxis":false,"yAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":false,"snap":false,"type":"shadow"}}],"xAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":true,"snap":true,"type":"shadow"}}],"showLegend":true,"legendPosition":"top","showLegendMetricName":false,"legendIcons":"radio","showInSingleMode":false,"showSimpleChartTitle":true,"chartAreaConfig":{"active":false}}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"}},"outputQuery":{},"aggs":{"metrics":[{"metric":"event_category","metricName":"event_category","useAggr":true,"field":"event_category","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countEvent_category=count(event_category)","postAggr":""},"alias":"countEvent_category","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true}],"buckets":[{"aggregation":"timeAggr","bucket":"timestamp","field":"timestamp","alias":"srcEventTimestamp","preFn":"timestamp","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":true,"type":"top","limit":10,"byMetric":"","byMetricSort":"desc","byField":[],"inverted":false,"showOthers":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":false},{"aggregation":"terms","useFn":false,"bucket":"event_category","field":"event_category","alias":"event_category","preFn":"event_category","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":true,"type":"top","limit":10,"byMetric":"","byMetricSort":"desc","byField":[],"inverted":false,"showOthers":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true,"splitChart":false}]},"sorters":[],"limit":{"active":true,"limit":100,"from":"head","othersShow":false},"queries":[{"nql":"src event_type = \"alert\" | (valInColl(event_category, \"2a2b3b6b-53f04ee9-a498c17d_0_event_category_bucket-limit\", \"event_category\") OR event_category = null) | timeAggr countEvent_category=count(event_category) on timestamp by event_category as event_category interval=\"${AUTOBUCKET_INTERVAL}\" dir=\"desc\" unwind=true bucketAlias=\"srcEventTimestamp\" | limit 100","subpipes":[{"nql":"${LIMIT_SOURCE} | src event_type = \"alert\" | neq(null, event_category) | aggr countEvent_category=count(event_category) by event_category as event_category unwind=true | sort countEvent_category desc | limit 10 | dst \"2a2b3b6b-53f04ee9-a498c17d_0_event_category_bucket-limit\""}]}],"includeTotal":{"hidden":false},"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136ca6-d89d1b5f-28fdb94f","permissions":{"entityId":"67136ca6-d89d1b5f-28fdb94f","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"15b66d12-4e94-4dde-bcc7-f73354e5a09a","header":null,"w":8,"h":5,"x":0,"y":7,"moved":false,"static":false},"config":{"$ref":"67136ca6-d89d1b5f-28fdb953","id":"67136ca6-d89d1b5f-28fdb953","name":"Suricata - Top Alert Categories","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830076391,"modified":1770830076391,"visualizationConfig":{"type":"chart","concreteVisualizationConfig":{"dataKey":"countCat","dataKeys":["countCat"],"categoryKey":"event_category","categoryKeys":["event_category"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[null]},"names":{"metrics":[{"custom":false,"value":"count(event_category)"}],"buckets":[{"custom":false,"value":"Alert Category"}]},"colors":{"metrics":[{"useCustomColor":false,"useDefaultColor":true}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"defaultFilterStream":["suricata"],"isCategoryDate":false,"categoryDateInterval":"","autoBucket":false,"timeKeys":[],"splitKeys":[],"splitChartsKeys":[],"splitSeriesKeys":[],"joinDataCategories":["event_category"],"gridIndexes":[0],"markers":[{"maxMarker":{},"minMarker":{},"maxLine":{},"minLine":{},"avgLine":{}}],"stack":{"metrics":[null]},"valueConfigs":{"metrics":[{"showLabels":false}]},"active":{"metrics":[true]},"sort":"desc","includeTotal":{"hidden":false},"type":"bar","hideTooMuchData":{"active":true,"value":502,"message":"To protect the browser performance, a limit of output records has been imposed on the widget. Please apply filters or narrow down the analysed time frame to display the results."},"hideTooMuchInputData":{"active":false},"noData":{"active":false},"animation":true,"drilldown":[],"showLocalQuerySwitch":false,"displayValuesOnXAxis":true,"yAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":false,"snap":false,"type":"shadow"}}],"xAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":true,"snap":true,"type":"shadow"}}],"showLegend":true,"legendPosition":"top","showLegendMetricName":false,"legendIcons":"radio","showInSingleMode":false,"showSimpleChartTitle":true,"chartAreaConfig":{"active":false}}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"}},"outputQuery":{},"aggs":{"metrics":[{"metric":"event_category","metricName":"event_category","useAggr":true,"field":"event_category","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countCat=count(event_category)","postAggr":""},"alias":"countCat","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true}],"buckets":[{"aggregation":"terms","useFn":false,"bucket":"event_category","field":"event_category","alias":"event_category","preFn":"event_category","autoBucket":false,"interval":"","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true}]},"sorters":[{"field":"countCat","direction":"desc","description":"count(event_category) (desc)"}],"limit":{"active":true,"limit":15,"from":"head","othersShow":false},"queries":[{"nql":"src event_type = \"alert\" | aggr countCat=count(event_category) by event_category as event_category unwind=true | sort countCat desc | limit 15","subpipes":[]}],"includeTotal":{"hidden":false},"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136ca6-d89d1b5f-28fdb953","permissions":{"entityId":"67136ca6-d89d1b5f-28fdb953","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"e3985bc1-a84c-4b7c-be09-bcc8a326ddee","header":null,"w":8,"h":5,"x":8,"y":7,"moved":false,"static":false},"config":{"$ref":"67136ca6-d89d1b5f-28fdb957","id":"67136ca6-d89d1b5f-28fdb957","name":"Suricata - Alerts by Protocol","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830076648,"modified":1770830076648,"visualizationConfig":{"type":"chart","concreteVisualizationConfig":{"dataKey":"countProto","dataKeys":["countProto"],"categoryKey":"proto","categoryKeys":["proto"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[null]},"names":{"metrics":[{"custom":false,"value":"count(proto)"}],"buckets":[{"custom":false,"value":"Protocol"}]},"colors":{"metrics":[{"useCustomColor":false,"useDefaultColor":true}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"defaultFilterStream":["suricata"],"isCategoryDate":false,"categoryDateInterval":"","autoBucket":false,"timeKeys":[],"splitKeys":[],"splitChartsKeys":[],"splitSeriesKeys":[],"joinDataCategories":["proto"],"gridIndexes":[0],"markers":[{"maxMarker":{},"minMarker":{},"maxLine":{},"minLine":{},"avgLine":{}}],"stack":{"metrics":[null]},"valueConfigs":{"metrics":[{"showLabels":false}]},"active":{"metrics":[true]},"sort":"desc","includeTotal":{"hidden":false},"type":"pie","hideTooMuchData":{"active":true,"value":502,"message":"To protect the browser performance, a limit of output records has been imposed on the widget. Please apply filters or narrow down the analysed time frame to display the results."},"hideTooMuchInputData":{"active":false},"noData":{"active":false},"animation":true,"drilldown":[],"showLocalQuerySwitch":false,"displayValuesOnXAxis":false,"yAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":false,"snap":false,"type":"shadow"}}],"xAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":true,"snap":true,"type":"shadow"}}],"showLegend":true,"legendPosition":"top","showLegendMetricName":false,"legendIcons":"radio","showInSingleMode":false,"showSimpleChartTitle":true,"chartAreaConfig":{"active":false}}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"}},"outputQuery":{},"aggs":{"metrics":[{"metric":"proto","metricName":"proto","useAggr":true,"field":"proto","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countProto=count(proto)","postAggr":""},"alias":"countProto","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true}],"buckets":[{"aggregation":"terms","useFn":false,"bucket":"proto","field":"proto","alias":"proto","preFn":"proto","autoBucket":false,"interval":"","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true}]},"sorters":[{"field":"countProto","direction":"desc","description":"count(proto) (desc)"}],"limit":{"active":true,"limit":10,"from":"head","othersShow":false},"queries":[{"nql":"src event_type = \"alert\" | aggr countProto=count(proto) by proto as proto unwind=true | sort countProto desc | limit 10","subpipes":[]}],"includeTotal":{"hidden":false},"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136ca6-d89d1b5f-28fdb957","permissions":{"entityId":"67136ca6-d89d1b5f-28fdb957","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"2f77eea2-bacb-422e-820a-3255ccb6a3ff","header":null,"w":8,"h":5,"x":16,"y":7,"moved":false,"static":false},"config":{"$ref":"67136ca6-d89d1b5f-28fdb95b","id":"67136ca6-d89d1b5f-28fdb95b","name":"Suricata - Alerts by App Protocol","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830076919,"modified":1770830076919,"visualizationConfig":{"type":"chart","concreteVisualizationConfig":{"dataKey":"countApp","dataKeys":["countApp"],"categoryKey":"app_proto","categoryKeys":["app_proto"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[null]},"names":{"metrics":[{"custom":false,"value":"count(app_proto)"}],"buckets":[{"custom":false,"value":"App Protocol"}]},"colors":{"metrics":[{"useCustomColor":false,"useDefaultColor":true}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"defaultFilterStream":["suricata"],"isCategoryDate":false,"categoryDateInterval":"","autoBucket":false,"timeKeys":[],"splitKeys":[],"splitChartsKeys":[],"splitSeriesKeys":[],"joinDataCategories":["app_proto"],"gridIndexes":[0],"markers":[{"maxMarker":{},"minMarker":{},"maxLine":{},"minLine":{},"avgLine":{}}],"stack":{"metrics":[null]},"valueConfigs":{"metrics":[{"showLabels":false}]},"active":{"metrics":[true]},"sort":"desc","includeTotal":{"hidden":false},"type":"pie","hideTooMuchData":{"active":true,"value":502,"message":"To protect the browser performance, a limit of output records has been imposed on the widget. Please apply filters or narrow down the analysed time frame to display the results."},"hideTooMuchInputData":{"active":false},"noData":{"active":false},"animation":true,"drilldown":[],"showLocalQuerySwitch":false,"displayValuesOnXAxis":false,"yAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":false,"snap":false,"type":"shadow"}}],"xAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":true,"snap":true,"type":"shadow"}}],"showLegend":true,"legendPosition":"top","showLegendMetricName":false,"legendIcons":"radio","showInSingleMode":false,"showSimpleChartTitle":true,"chartAreaConfig":{"active":false}}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"}},"outputQuery":{},"aggs":{"metrics":[{"metric":"app_proto","metricName":"app_proto","useAggr":true,"field":"app_proto","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countApp=count(app_proto)","postAggr":""},"alias":"countApp","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true}],"buckets":[{"aggregation":"terms","useFn":false,"bucket":"app_proto","field":"app_proto","alias":"app_proto","preFn":"app_proto","autoBucket":false,"interval":"","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true}]},"sorters":[{"field":"countApp","direction":"desc","description":"count(app_proto) (desc)"}],"limit":{"active":true,"limit":10,"from":"head","othersShow":false},"queries":[{"nql":"src event_type = \"alert\" | aggr countApp=count(app_proto) by app_proto as app_proto unwind=true | sort countApp desc | limit 10","subpipes":[]}],"includeTotal":{"hidden":false},"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136ca6-d89d1b5f-28fdb95b","permissions":{"entityId":"67136ca6-d89d1b5f-28fdb95b","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"30784200-220e-43c8-9a4f-67882fe5f1c0","header":null,"w":14,"h":6,"x":0,"y":12,"moved":false,"static":false},"config":{"$ref":"67136ca7-d89d1b5f-28fdb95f","id":"67136ca7-d89d1b5f-28fdb95f","name":"Suricata - Alert Detail Table","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830077188,"modified":1770830077188,"visualizationConfig":{"type":"table","concreteVisualizationConfig":{"dataKey":"event_category","dataKeys":["event_category","minSeverity","alert_action","sigId","protocol","countSig"],"categoryKey":"event_signature","categoryKeys":["event_signature"],"formatting":{"metrics":[null,null,null,null,null,null],"buckets":[{"formattingType":"off"}]},"names":{"metrics":[{"value":"Category"},{"value":"Severity"},{"value":"Action"},{"value":"SID"},{"value":"Protocol"},{"custom":false,"value":"Count"}],"buckets":[{"custom":true,"value":"Signature"}]},"colors":{"metrics":[{"useDefaultColor":true},{"useDefaultColor":true},{"useDefaultColor":true},{"useDefaultColor":true},{"useDefaultColor":true},{"useDefaultColor":true}]},"thresholds":{"metrics":[null,null,null,null,null,null]},"areThresholdsAbsolute":{"metrics":[null,null,null,null,null,null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"defaultFilterStream":["suricata"],"columns":[{"active":true,"columnType":"bucket","alias":"event_signature","aggregation":"terms","field":"event_signature","fieldName":"event_signature","useFn":false,"isSavedField":false,"fn":{},"bucket":"event_signature","preFn":"event_signature","filterFn":{"custom":false},"isStringFieldType":true,"isNumberFieldType":false,"isCollectionFieldType":false,"unwindCollection":false,"autoBucket":true,"interval":"5m","visualOptions":{"label":"Signature","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":true,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"event_signature"},{"active":true,"columnType":"column","alias":"event_category","field":"event_category","fieldName":"event_category","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"event_category","column":"event_category","visualOptions":{"label":"Category","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"event_category","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"column","alias":"minSeverity","field":"alert_severity","fieldName":"alert_severity","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"alert_severity","column":"minSeverity","visualOptions":{"label":"Severity","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"minSeverity","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"column","alias":"alert_action","field":"alert_action","fieldName":"alert_action","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"alert_action","column":"alert_action","visualOptions":{"label":"Action","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"alert_action","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"column","alias":"sigId","field":"alert_signature_id","fieldName":"alert_signature_id","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"alert_signature_id","column":"sigId","visualOptions":{"label":"SID","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"sigId","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"column","alias":"protocol","field":"proto","fieldName":"proto","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"proto","column":"protocol","visualOptions":{"label":"Protocol","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"protocol","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"metric","metric":"event_signature","alias":"countSig","aggregation":"count","useAggr":true,"metricName":"event_signature","field":"event_signature","fieldName":"count(event_signature)","fieldType":"field","aggrParams":{},"fn":{"aggr":"countSig=count(event_signature)","postAggr":""},"visualOptions":{"label":"Count","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"metricBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"countSig","isStringFieldType":false,"isCollectionFieldType":false,"isNumberFieldType":true}],"includeTotal":{"active":false,"hidden":false},"groupRowsByOrder":1,"type":"table","hideTooMuchData":{"active":true,"value":502,"message":"To protect the browser performance, a limit of output records has been imposed on the widget. Please apply filters or narrow down the analysed time frame to display the results."},"hideTooMuchInputData":{"active":false},"noData":{"active":false},"drilldown":[],"showLocalQuerySwitch":false,"globalFilter":true,"filterable":true,"sortable":true,"displayValuesOnXAxis":false,"rowGroupMode":null,"groupRowsBy":null}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"}},"outputQuery":{},"aggs":{"metrics":[{"metric":"event_category","field":"event_category","aggregation":"first","fn":{"aggr":"event_category=first(event_category)"},"alias":"event_category"},{"metric":"alert_severity","field":"alert_severity","aggregation":"min","fn":{"aggr":"minSeverity=min(alert_severity)"},"alias":"minSeverity"},{"metric":"alert_action","field":"alert_action","aggregation":"first","fn":{"aggr":"alert_action=first(alert_action)"},"alias":"alert_action"},{"metric":"alert_signature_id","field":"alert_signature_id","aggregation":"first","fn":{"aggr":"sigId=first(alert_signature_id)"},"alias":"sigId"},{"metric":"proto","field":"proto","aggregation":"first","fn":{"aggr":"protocol=first(proto)"},"alias":"protocol"},{"metric":"event_signature","metricName":"event_signature","useAggr":true,"field":"event_signature","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countSig=count(event_signature)","postAggr":""},"alias":"countSig","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true}],"buckets":[{"aggregation":"terms","useFn":false,"bucket":"event_signature","field":"event_signature","alias":"event_signature","preFn":"event_signature","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true}]},"sorters":[{"field":"countSig","direction":"desc","description":"countSig (desc)"}],"limit":{"active":true,"limit":50,"from":"head","othersShow":false},"queries":[{"nql":"src event_type = \"alert\" | aggr event_category=first(event_category), minSeverity=min(alert_severity), alert_action=first(alert_action), sigId=first(alert_signature_id), protocol=first(proto), countSig=count(event_signature) by event_signature as event_signature unwind=true | sort countSig desc | limit 50","subpipes":[]}],"columns":[{"active":true,"columnType":"bucket","alias":"event_signature","aggregation":"terms","field":"event_signature","fieldName":"event_signature","useFn":false,"isSavedField":false,"fn":{},"bucket":"event_signature","preFn":"event_signature","filterFn":{"custom":false},"isStringFieldType":true,"isNumberFieldType":false,"isCollectionFieldType":false,"unwindCollection":false,"autoBucket":true,"interval":"5m","visualOptions":{"label":"Signature","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":true,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"event_signature"},{"active":true,"columnType":"column","alias":"event_category","field":"event_category","fieldName":"event_category","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"event_category","column":"event_category","visualOptions":{"label":"Category","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"event_category","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"column","alias":"minSeverity","field":"alert_severity","fieldName":"alert_severity","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"alert_severity","column":"minSeverity","visualOptions":{"label":"Severity","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"minSeverity","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"column","alias":"alert_action","field":"alert_action","fieldName":"alert_action","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"alert_action","column":"alert_action","visualOptions":{"label":"Action","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"alert_action","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"column","alias":"sigId","field":"alert_signature_id","fieldName":"alert_signature_id","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"alert_signature_id","column":"sigId","visualOptions":{"label":"SID","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"sigId","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"column","alias":"protocol","field":"proto","fieldName":"proto","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"proto","column":"protocol","visualOptions":{"label":"Protocol","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"protocol","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"metric","metric":"event_signature","alias":"countSig","aggregation":"count","useAggr":true,"metricName":"event_signature","field":"event_signature","fieldName":"count(event_signature)","fieldType":"field","aggrParams":{},"fn":{"aggr":"countSig=count(event_signature)","postAggr":""},"visualOptions":{"label":"Count","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"metricBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"countSig","isStringFieldType":false,"isCollectionFieldType":false,"isNumberFieldType":true}],"includeTotal":{"active":false,"hidden":false}},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136ca7-d89d1b5f-28fdb95f","permissions":{"entityId":"67136ca7-d89d1b5f-28fdb95f","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"29108640-1d66-4867-b7d2-7d3448f03c8f","header":null,"w":10,"h":6,"x":14,"y":12,"moved":false,"static":false},"config":{"$ref":"67136ca7-d89d1b5f-28fdb964","id":"67136ca7-d89d1b5f-28fdb964","name":"Suricata - Top Conversation Pairs","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830077523,"modified":1770830077523,"visualizationConfig":{"type":"table","concreteVisualizationConfig":{"dataKey":"lastSig","dataKeys":["lastSig","countPair","uniqueSigs"],"categoryKey":"src_ip","categoryKeys":["src_ip","dest_ip"],"formatting":{"metrics":[null,null,null],"buckets":[{"formattingType":"off"},{"formattingType":"off"}]},"names":{"metrics":[{"value":"Last Signature"},{"custom":false,"value":"Alert Count"},{"custom":false,"value":"Unique Sigs"}],"buckets":[{"custom":true,"value":"Source IP"},{"custom":true,"value":"Destination IP"}]},"colors":{"metrics":[{"useDefaultColor":true},{"useDefaultColor":true},{"useDefaultColor":true}]},"thresholds":{"metrics":[null,null,null]},"areThresholdsAbsolute":{"metrics":[null,null,null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"defaultFilterStream":["suricata","suricata"],"columns":[{"active":true,"columnType":"bucket","alias":"src_ip","aggregation":"terms","field":"src_ip","fieldName":"src_ip","useFn":false,"isSavedField":false,"fn":{},"bucket":"src_ip","preFn":"src_ip","filterFn":{"custom":false},"isStringFieldType":true,"isNumberFieldType":false,"isCollectionFieldType":false,"unwindCollection":false,"autoBucket":true,"interval":"5m","visualOptions":{"label":"Source IP","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":true,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"src_ip"},{"active":true,"columnType":"bucket","alias":"dest_ip","aggregation":"terms","field":"dest_ip","fieldName":"dest_ip","useFn":false,"isSavedField":false,"fn":{},"bucket":"dest_ip","preFn":"dest_ip","filterFn":{"custom":false},"isStringFieldType":true,"isNumberFieldType":false,"isCollectionFieldType":false,"unwindCollection":false,"autoBucket":true,"interval":"5m","visualOptions":{"label":"Destination IP","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":true,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"dest_ip"},{"active":true,"columnType":"column","alias":"lastSig","field":"event_signature","fieldName":"event_signature","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"event_signature","column":"lastSig","visualOptions":{"label":"Last Signature","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"lastSig","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"metric","metric":"src_ip","alias":"countPair","aggregation":"count","useAggr":true,"metricName":"src_ip","field":"src_ip","fieldName":"count(src_ip)","fieldType":"field","aggrParams":{},"fn":{"aggr":"countPair=count(src_ip)","postAggr":""},"visualOptions":{"label":"Alert Count","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"metricBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"countPair","isStringFieldType":false,"isCollectionFieldType":false,"isNumberFieldType":true},{"active":true,"columnType":"metric","metric":"event_signature","alias":"uniqueSigs","aggregation":"dc","useAggr":true,"metricName":"event_signature","field":"event_signature","fieldName":"dc(event_signature)","fieldType":"field","aggrParams":{},"fn":{"aggr":"uniqueSigs=dc(event_signature)","postAggr":""},"visualOptions":{"label":"Unique Sigs","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"metricBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"uniqueSigs","isStringFieldType":false,"isCollectionFieldType":false,"isNumberFieldType":true}],"includeTotal":{"active":false,"hidden":false},"groupRowsByOrder":1,"type":"table","hideTooMuchData":{"active":true,"value":502,"message":"To protect the browser performance, a limit of output records has been imposed on the widget. Please apply filters or narrow down the analysed time frame to display the results."},"hideTooMuchInputData":{"active":false},"noData":{"active":false},"drilldown":[],"showLocalQuerySwitch":false,"globalFilter":true,"filterable":true,"sortable":true,"displayValuesOnXAxis":false,"rowGroupMode":null,"groupRowsBy":null}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"}},"outputQuery":{},"aggs":{"metrics":[{"metric":"event_signature","field":"event_signature","aggregation":"first","fn":{"aggr":"lastSig=first(event_signature)"},"alias":"lastSig"},{"metric":"src_ip","metricName":"src_ip","useAggr":true,"field":"src_ip","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countPair=count(src_ip)","postAggr":""},"alias":"countPair","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true},{"metric":"event_signature","metricName":"event_signature","useAggr":true,"field":"event_signature","fieldType":"field","aggregation":"dc","aggrParams":{},"fn":{"aggr":"uniqueSigs=dc(event_signature)","postAggr":""},"alias":"uniqueSigs","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true}],"buckets":[{"aggregation":"terms","useFn":false,"bucket":"src_ip","field":"src_ip","alias":"src_ip","preFn":"src_ip","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true},{"aggregation":"terms","useFn":false,"bucket":"dest_ip","field":"dest_ip","alias":"dest_ip","preFn":"dest_ip","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true}]},"sorters":[{"field":"countPair","direction":"desc","description":"countPair (desc)"}],"limit":{"active":true,"limit":50,"from":"head","othersShow":false},"queries":[{"nql":"src event_type = \"alert\" | aggr lastSig=first(event_signature), countPair=count(src_ip), uniqueSigs=dc(event_signature) by src_ip as src_ip, dest_ip as dest_ip unwind=true | sort countPair desc | limit 50","subpipes":[]}],"columns":[{"active":true,"columnType":"bucket","alias":"src_ip","aggregation":"terms","field":"src_ip","fieldName":"src_ip","useFn":false,"isSavedField":false,"fn":{},"bucket":"src_ip","preFn":"src_ip","filterFn":{"custom":false},"isStringFieldType":true,"isNumberFieldType":false,"isCollectionFieldType":false,"unwindCollection":false,"autoBucket":true,"interval":"5m","visualOptions":{"label":"Source IP","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":true,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"src_ip"},{"active":true,"columnType":"bucket","alias":"dest_ip","aggregation":"terms","field":"dest_ip","fieldName":"dest_ip","useFn":false,"isSavedField":false,"fn":{},"bucket":"dest_ip","preFn":"dest_ip","filterFn":{"custom":false},"isStringFieldType":true,"isNumberFieldType":false,"isCollectionFieldType":false,"unwindCollection":false,"autoBucket":true,"interval":"5m","visualOptions":{"label":"Destination IP","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":true,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"dest_ip"},{"active":true,"columnType":"column","alias":"lastSig","field":"event_signature","fieldName":"event_signature","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"event_signature","column":"lastSig","visualOptions":{"label":"Last Signature","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"lastSig","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"metric","metric":"src_ip","alias":"countPair","aggregation":"count","useAggr":true,"metricName":"src_ip","field":"src_ip","fieldName":"count(src_ip)","fieldType":"field","aggrParams":{},"fn":{"aggr":"countPair=count(src_ip)","postAggr":""},"visualOptions":{"label":"Alert Count","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"metricBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"countPair","isStringFieldType":false,"isCollectionFieldType":false,"isNumberFieldType":true},{"active":true,"columnType":"metric","metric":"event_signature","alias":"uniqueSigs","aggregation":"dc","useAggr":true,"metricName":"event_signature","field":"event_signature","fieldName":"dc(event_signature)","fieldType":"field","aggrParams":{},"fn":{"aggr":"uniqueSigs=dc(event_signature)","postAggr":""},"visualOptions":{"label":"Unique Sigs","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"metricBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"uniqueSigs","isStringFieldType":false,"isCollectionFieldType":false,"isNumberFieldType":true}],"includeTotal":{"active":false,"hidden":false}},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136ca7-d89d1b5f-28fdb964","permissions":{"entityId":"67136ca7-d89d1b5f-28fdb964","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}}],"version":5,"descriptionDefaultShow":true,"acl":{"permissions":[],"privacy":"public","publicPermissions":[],"entityId":"67136ca7-d89d1b5f-28fdb968","entityType":"COMPONENT.dashboard","owner":"admin","availPerms":["VIEW","EDIT","ADD","DELETE","EXECUTE","MODIFY_OWNERSHIP","GRANT_PERMISSIONS"],"isOwner":true,"aclEdit":true},"entitySet":"COMPONENT","entityType":"dashboard","annotations":null,"permissions":{"entityId":"67136ca7-d89d1b5f-28fdb968","entityType":"COMPONENT.dashboard","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true},"aclEdit":true}