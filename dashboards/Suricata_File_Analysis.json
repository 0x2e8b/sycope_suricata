{"name":"Suricata File Analysis","type":"dashboard","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830129916,"modified":1770830129916,"dashboardConfig":{"cols":24,"gridType":"proportional","rows":18,"compactType":null,"widgetSpacing":8,"disableVisAnimations":false,"dashboardType":"standard","type":"standard","related":[],"requireFilters":{},"requireTimerange":{"maxRange":"30m"}},"items":[{"layout":{"id":"a1b2c3d4-1111-4aaa-bbbb-000000000001","header":{"hideTitle":true},"w":8,"h":2,"x":0,"y":0,"moved":false,"static":false},"config":{"$ref":"67136cd8-d89d1b5f-28fdba07","id":"67136cd8-d89d1b5f-28fdba07","name":"Suricata - Total Files","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830127503,"modified":1770830127503,"visualizationConfig":{"type":"kpi","concreteVisualizationConfig":{"dataKey":"countFiles","dataKeys":["countFiles"],"categoryKey":"_bucket","categoryKeys":["_bucket"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[]},"names":{"metrics":[{"custom":true,"value":"Total Files"}],"buckets":[]},"colors":{"metrics":[{"useCustomColor":false,"useDefaultColor":true}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"dataConfigs":[{"label":"Total Files","fontSize":"md","align":"center","labelColor":{"useCustomColor":false},"iconOptions":{"icon":""}}],"type":"kpi","hideTooMuchInputData":{"active":false},"drilldown":[]}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"},"query":"","advanced":false},"outputQuery":{},"aggs":{"metrics":[{"metric":"event_type","metricName":"event_type","useAggr":true,"field":"event_type","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countFiles=count(event_type)","postAggr":""},"alias":"countFiles"}],"buckets":[]},"limit":{"active":true,"othersShow":false,"limit":1000,"from":"head"},"queries":[{"nql":"src event_type = \"fileinfo\" | aggr countFiles=count(event_type) unwind=true | limit 1000","subpipes":[]}],"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136cd8-d89d1b5f-28fdba07","permissions":{"entityId":"67136cd8-d89d1b5f-28fdba07","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"a1b2c3d4-2222-4aaa-bbbb-000000000002","header":{"hideTitle":true},"w":8,"h":2,"x":8,"y":0,"moved":false,"static":false},"config":{"$ref":"67136cd8-d89d1b5f-28fdba0b","id":"67136cd8-d89d1b5f-28fdba0b","name":"Suricata - Unique Hashes","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830127745,"modified":1770830127745,"visualizationConfig":{"type":"kpi","concreteVisualizationConfig":{"dataKey":"uniqueHashes","dataKeys":["uniqueHashes"],"categoryKey":"_bucket","categoryKeys":["_bucket"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[]},"names":{"metrics":[{"custom":true,"value":"Unique Hashes"}],"buckets":[]},"colors":{"metrics":[{"useCustomColor":false,"useDefaultColor":true}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"dataConfigs":[{"label":"Unique Hashes","fontSize":"md","align":"center","labelColor":{"useCustomColor":false},"iconOptions":{"icon":""}}],"type":"kpi","hideTooMuchInputData":{"active":false},"drilldown":[]}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"},"query":"","advanced":false},"outputQuery":{},"aggs":{"metrics":[{"metric":"file_sha256","metricName":"file_sha256","useAggr":true,"field":"file_sha256","fieldType":"field","aggregation":"dc","aggrParams":{},"fn":{"aggr":"uniqueHashes=dc(file_sha256)","postAggr":""},"alias":"uniqueHashes"}],"buckets":[]},"limit":{"active":true,"othersShow":false,"limit":1000,"from":"head"},"queries":[{"nql":"src event_type = \"fileinfo\" | aggr uniqueHashes=dc(file_sha256) unwind=true | limit 1000","subpipes":[]}],"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136cd8-d89d1b5f-28fdba0b","permissions":{"entityId":"67136cd8-d89d1b5f-28fdba0b","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"a1b2c3d4-3333-4aaa-bbbb-000000000003","header":{"hideTitle":true},"w":8,"h":2,"x":16,"y":0,"moved":false,"static":false},"config":{"$ref":"67136cd8-d89d1b5f-28fdba0f","id":"67136cd8-d89d1b5f-28fdba0f","name":"Suricata - File Types","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830127988,"modified":1770830127988,"visualizationConfig":{"type":"kpi","concreteVisualizationConfig":{"dataKey":"uniqueMagic","dataKeys":["uniqueMagic"],"categoryKey":"_bucket","categoryKeys":["_bucket"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[]},"names":{"metrics":[{"custom":true,"value":"File Types"}],"buckets":[]},"colors":{"metrics":[{"useCustomColor":false,"useDefaultColor":true}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"dataConfigs":[{"label":"File Types","fontSize":"md","align":"center","labelColor":{"useCustomColor":false},"iconOptions":{"icon":""}}],"type":"kpi","hideTooMuchInputData":{"active":false},"drilldown":[]}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"},"query":"","advanced":false},"outputQuery":{},"aggs":{"metrics":[{"metric":"file_magic","metricName":"file_magic","useAggr":true,"field":"file_magic","fieldType":"field","aggregation":"dc","aggrParams":{},"fn":{"aggr":"uniqueMagic=dc(file_magic)","postAggr":""},"alias":"uniqueMagic"}],"buckets":[]},"limit":{"active":true,"othersShow":false,"limit":1000,"from":"head"},"queries":[{"nql":"src event_type = \"fileinfo\" | aggr uniqueMagic=dc(file_magic) unwind=true | limit 1000","subpipes":[]}],"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136cd8-d89d1b5f-28fdba0f","permissions":{"entityId":"67136cd8-d89d1b5f-28fdba0f","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"a1b2c3d4-4444-4aaa-bbbb-000000000004","header":null,"w":14,"h":5,"x":0,"y":2,"moved":false,"static":false},"config":{"$ref":"67136cd9-d89d1b5f-28fdba13","id":"67136cd9-d89d1b5f-28fdba13","name":"Suricata - Files Over Time by Protocol","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830128234,"modified":1770892967490,"visualizationConfig":{"type":"chart","concreteVisualizationConfig":{"dataKey":"countFiles","dataKeys":["countFiles"],"categoryKey":"srcEventTimestamp","categoryKeys":["srcEventTimestamp","app_proto"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[{"formattingType":"date","formattingPattern":"yyyy-MM-dd HH:mm"},null]},"names":{"metrics":[{"custom":false,"value":"count(Files)"}],"buckets":[{"custom":true,"value":"Time"},{"custom":true,"value":"Protocol"}]},"colors":{"metrics":[{"useCustomColor":false,"useDefaultColor":true}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"defaultFilterStream":["suricata","suricata"],"isCategoryDate":true,"categoryDateInterval":"5m","autoBucket":true,"timeKeys":["srcEventTimestamp"],"splitKeys":["app_proto"],"splitChartsKeys":[],"splitSeriesKeys":["app_proto"],"joinDataCategories":["srcEventTimestamp"],"gridIndexes":[0],"markers":[{"maxMarker":{},"minMarker":{},"maxLine":{},"minLine":{},"avgLine":{}}],"stack":{"metrics":["Type"]},"valueConfigs":{"metrics":[{"showLabels":false}]},"active":{"metrics":[true]},"sort":"desc","includeTotal":{"hidden":false},"type":"bar","hideTooMuchData":{"active":true,"value":502,"message":"To protect the browser performance, a limit of output records has been imposed on the widget. Please apply filters or narrow down the analysed time frame to display the results."},"hideTooMuchInputData":{"active":false},"noData":{"active":false},"animation":true,"drilldown":[],"showLocalQuerySwitch":false,"displayValuesOnXAxis":false,"yAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":false,"snap":false,"type":"shadow"}}],"xAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":true,"snap":true,"type":"shadow"}}],"showLegend":true,"legendPosition":"top","showLegendMetricName":false,"legendIcons":"radio","showInSingleMode":false,"showSimpleChartTitle":true,"chartAreaConfig":{"active":false}}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"},"query":"","advanced":false},"outputQuery":{},"aggs":{"metrics":[{"metric":"event_type","metricName":"Files","useAggr":true,"field":"event_type","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countFiles=count(event_type)","postAggr":""},"alias":"countFiles","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true}],"buckets":[{"aggregation":"timeAggr","bucket":"timestamp","field":"timestamp","alias":"srcEventTimestamp","preFn":"timestamp","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":true,"type":"top","limit":10,"byMetric":"","byMetricSort":"desc","byField":[],"inverted":false,"showOthers":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":false},{"aggregation":"terms","useFn":false,"bucket":"app_proto","field":"app_proto","alias":"app_proto","preFn":"app_proto","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":true,"type":"top","limit":10,"byMetric":"","byMetricSort":"desc","byField":[],"inverted":false,"showOthers":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true,"splitChart":false}]},"sorters":[],"limit":{"active":true,"limit":1000,"from":"head","othersShow":false},"queries":[{"nql":"(valInColl(app_proto, \"${UNIQUE_ID_0}\", \"app_proto\") OR app_proto = null) | timeAggr countFiles=count(event_type) on timestamp by app_proto as app_proto interval=\"${AUTOBUCKET_INTERVAL}\" dir=\"desc\" unwind=true bucketAlias=\"srcEventTimestamp\" | limit 1000","subpipes":[{"nql":"${LIMIT_SOURCE} | neq(null, app_proto) | aggr countFiles=count(event_type) by app_proto as app_proto unwind=true | sort countFiles desc | limit 10 | dst \"${UNIQUE_ID_0}\""}]}],"includeTotal":{"hidden":false},"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136cd9-d89d1b5f-28fdba13","permissions":{"entityId":"67136cd9-d89d1b5f-28fdba13","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"a1b2c3d4-5555-4aaa-bbbb-000000000005","header":null,"w":10,"h":5,"x":14,"y":2,"moved":false,"static":false},"config":{"$ref":"67136cd9-d89d1b5f-28fdba17","id":"67136cd9-d89d1b5f-28fdba17","name":"Suricata - File Type Distribution","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830128484,"modified":1770830128484,"visualizationConfig":{"type":"chart","concreteVisualizationConfig":{"dataKey":"countMagic","dataKeys":["countMagic"],"categoryKey":"file_magic","categoryKeys":["file_magic"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[{"formattingType":"off"}]},"names":{"metrics":[{"custom":false,"value":"count(File Type)"}],"buckets":[{"custom":false,"value":"File Type"}]},"colors":{"metrics":[{"useCustomColor":false,"useDefaultColor":true}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"defaultFilterStream":["suricata"],"isCategoryDate":false,"categoryDateInterval":"5m","autoBucket":false,"timeKeys":[],"splitKeys":[],"splitChartsKeys":[],"splitSeriesKeys":[],"joinDataCategories":[],"gridIndexes":[0],"markers":[{"maxMarker":{},"minMarker":{},"maxLine":{},"minLine":{},"avgLine":{}}],"stack":{"metrics":[null]},"valueConfigs":{"metrics":[{"showLabels":false}]},"active":{"metrics":[true]},"sort":"desc","includeTotal":{"hidden":false},"type":"pie","hideTooMuchData":{"active":true,"value":502,"message":"To protect the browser performance, a limit of output records has been imposed on the widget. Please apply filters or narrow down the analysed time frame to display the results."},"hideTooMuchInputData":{"active":false},"noData":{"active":false},"animation":true,"drilldown":[],"showLocalQuerySwitch":false,"displayValuesOnXAxis":false,"yAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":false,"snap":false,"type":"shadow"}}],"xAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":true,"snap":true,"type":"shadow"}}],"showLegend":true,"legendPosition":"top","showLegendMetricName":false,"legendIcons":"radio","showInSingleMode":false,"showSimpleChartTitle":true,"chartAreaConfig":{"active":false}}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"},"query":"","advanced":false},"outputQuery":{},"aggs":{"metrics":[{"metric":"file_magic","metricName":"File Type","useAggr":true,"field":"file_magic","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countMagic=count(file_magic)","postAggr":""},"alias":"countMagic","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true}],"buckets":[{"aggregation":"terms","useFn":false,"bucket":"file_magic","field":"file_magic","alias":"file_magic","preFn":"file_magic","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true}]},"sorters":[],"limit":{"active":true,"limit":15,"from":"head","othersShow":false},"queries":[{"nql":"src event_type = \"fileinfo\" | aggr countMagic=count(file_magic) by file_magic as file_magic unwind=true | sort countMagic desc | limit 15","subpipes":[]}],"includeTotal":{"hidden":false},"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136cd9-d89d1b5f-28fdba17","permissions":{"entityId":"67136cd9-d89d1b5f-28fdba17","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"a1b2c3d4-6666-4aaa-bbbb-000000000006","header":null,"w":8,"h":5,"x":0,"y":7,"moved":false,"static":false},"config":{"$ref":"67136cd9-d89d1b5f-28fdba1b","id":"67136cd9-d89d1b5f-28fdba1b","name":"Suricata - Files by Application Protocol","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830128758,"modified":1770830128758,"visualizationConfig":{"type":"chart","concreteVisualizationConfig":{"dataKey":"countApp","dataKeys":["countApp"],"categoryKey":"app_proto","categoryKeys":["app_proto"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[{"formattingType":"off"}]},"names":{"metrics":[{"custom":false,"value":"count(Application Protocol)"}],"buckets":[{"custom":false,"value":"Application Protocol"}]},"colors":{"metrics":[{"useCustomColor":false,"useDefaultColor":true}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"defaultFilterStream":["suricata"],"isCategoryDate":false,"categoryDateInterval":"5m","autoBucket":false,"timeKeys":[],"splitKeys":[],"splitChartsKeys":[],"splitSeriesKeys":[],"joinDataCategories":[],"gridIndexes":[0],"markers":[{"maxMarker":{},"minMarker":{},"maxLine":{},"minLine":{},"avgLine":{}}],"stack":{"metrics":[null]},"valueConfigs":{"metrics":[{"showLabels":false}]},"active":{"metrics":[true]},"sort":"desc","includeTotal":{"hidden":false},"type":"pie","hideTooMuchData":{"active":true,"value":502,"message":"To protect the browser performance, a limit of output records has been imposed on the widget. Please apply filters or narrow down the analysed time frame to display the results."},"hideTooMuchInputData":{"active":false},"noData":{"active":false},"animation":true,"drilldown":[],"showLocalQuerySwitch":false,"displayValuesOnXAxis":false,"yAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":false,"snap":false,"type":"shadow"}}],"xAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":true,"snap":true,"type":"shadow"}}],"showLegend":true,"legendPosition":"top","showLegendMetricName":false,"legendIcons":"radio","showInSingleMode":false,"showSimpleChartTitle":true,"chartAreaConfig":{"active":false}}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"},"query":"","advanced":false},"outputQuery":{},"aggs":{"metrics":[{"metric":"app_proto","metricName":"Application Protocol","useAggr":true,"field":"app_proto","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countApp=count(app_proto)","postAggr":""},"alias":"countApp","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true}],"buckets":[{"aggregation":"terms","useFn":false,"bucket":"app_proto","field":"app_proto","alias":"app_proto","preFn":"app_proto","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true}]},"sorters":[],"limit":{"active":true,"limit":10,"from":"head","othersShow":false},"queries":[{"nql":"src event_type = \"fileinfo\" | aggr countApp=count(app_proto) by app_proto as app_proto unwind=true | sort countApp desc | limit 10","subpipes":[]}],"includeTotal":{"hidden":false},"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136cd9-d89d1b5f-28fdba1b","permissions":{"entityId":"67136cd9-d89d1b5f-28fdba1b","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"a1b2c3d4-7777-4aaa-bbbb-000000000007","header":null,"w":16,"h":5,"x":8,"y":7,"moved":false,"static":false},"config":{"$ref":"67136cd9-d89d1b5f-28fdba1f","id":"67136cd9-d89d1b5f-28fdba1f","name":"Suricata - Top File Names","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830129062,"modified":1770830129062,"visualizationConfig":{"type":"chart","concreteVisualizationConfig":{"dataKey":"countName","dataKeys":["countName"],"categoryKey":"file_name","categoryKeys":["file_name"],"formatting":{"metrics":[{"formattingType":"off"}],"buckets":[null]},"names":{"metrics":[{"custom":false,"value":"count(File Name)"}],"buckets":[{"custom":false,"value":"File Name"}]},"colors":{"metrics":[{"useCustomColor":false,"useDefaultColor":true}]},"thresholds":{"metrics":[null]},"areThresholdsAbsolute":{"metrics":[null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"defaultFilterStream":["suricata"],"isCategoryDate":false,"categoryDateInterval":"","autoBucket":false,"timeKeys":[],"splitKeys":[],"splitChartsKeys":[],"splitSeriesKeys":[],"joinDataCategories":["file_name"],"gridIndexes":[0],"markers":[{"maxMarker":{},"minMarker":{},"maxLine":{},"minLine":{},"avgLine":{}}],"stack":{"metrics":[null]},"valueConfigs":{"metrics":[{"showLabels":false}]},"active":{"metrics":[true]},"sort":"desc","includeTotal":{"hidden":false},"type":"bar","hideTooMuchData":{"active":true,"value":502,"message":"To protect the browser performance, a limit of output records has been imposed on the widget. Please apply filters or narrow down the analysed time frame to display the results."},"hideTooMuchInputData":{"active":false},"noData":{"active":false},"animation":true,"drilldown":[],"showLocalQuerySwitch":false,"displayValuesOnXAxis":true,"yAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":false,"snap":false,"type":"shadow"}}],"xAxes":[{"series":[0],"position":"default","useCustomName":false,"showAxisLabels":true,"axisLabelStyles":{"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"width":100,"labelAngle":0,"labelPosition":"outside","forceAllLabels":false,"formatting":{"formattingType":"off"},"logScale":false,"inverse":false,"barCategoryGapCustom":false,"axisLine":{"custom":false},"splitLine":{"custom":false},"axisPointerConfig":{"show":true,"snap":true,"type":"shadow"}}],"showLegend":true,"legendPosition":"top","showLegendMetricName":false,"legendIcons":"radio","showInSingleMode":false,"showSimpleChartTitle":true,"chartAreaConfig":{"active":false}}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"},"query":"","advanced":false},"outputQuery":{},"aggs":{"metrics":[{"metric":"file_name","metricName":"file_name","useAggr":true,"field":"file_name","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countName=count(file_name)","postAggr":""},"alias":"countName","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true}],"buckets":[{"aggregation":"terms","useFn":false,"bucket":"file_name","field":"file_name","alias":"file_name","preFn":"file_name","autoBucket":false,"interval":"","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true}]},"sorters":[{"field":"countName","direction":"desc","description":"count(file_name) (desc)"}],"limit":{"active":true,"limit":20,"from":"head","othersShow":false},"queries":[{"nql":"src event_type = \"fileinfo\" | aggr countName=count(file_name) by file_name as file_name unwind=true | sort countName desc | limit 20","subpipes":[]}],"includeTotal":{"hidden":false},"columns":[]},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136cd9-d89d1b5f-28fdba1f","permissions":{"entityId":"67136cd9-d89d1b5f-28fdba1f","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"a1b2c3d4-8888-4aaa-bbbb-000000000008","header":null,"w":14,"h":6,"x":0,"y":12,"moved":false,"static":false},"config":{"$ref":"67136cda-d89d1b5f-28fdba23","id":"67136cda-d89d1b5f-28fdba23","name":"Suricata - Top File Hashes","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830129395,"modified":1770841013080,"visualizationConfig":{"type":"table","concreteVisualizationConfig":{"dataKey":"firstName","dataKeys":["firstName","firstProto","firstMagic","firstSize","countHash"],"categoryKey":"file_sha256","categoryKeys":["file_sha256","file_md5","file_sha1"],"formatting":{"metrics":[null,null,null,null,{"formattingType":"off"}],"buckets":[{"formattingType":"off"},{"formattingType":"off"},{"formattingType":"off"}]},"names":{"metrics":[{"value":"first(file_name)"},{"value":"first(app_proto)"},{"value":"first(file_magic)"},{"value":"first(file_size)"},{"custom":true,"value":"Count"}],"buckets":[{"custom":true,"value":"SHA256"},{"custom":false,"value":"File MD5"},{"custom":false,"value":"File SHA1"}]},"colors":{"metrics":[{"useDefaultColor":true},{"useDefaultColor":true},{"useDefaultColor":true},{"useDefaultColor":true},{"useDefaultColor":true}]},"thresholds":{"metrics":[null,null,null,null,null]},"areThresholdsAbsolute":{"metrics":[null,null,null,null,null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"defaultFilterStream":["suricata","suricata","suricata"],"columns":[{"active":true,"columnType":"column","alias":"firstName","field":"file_name","fieldName":"file_name","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"file_name","column":"firstName","visualOptions":{"label":"File Name","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":true,"defaultColWidth":150,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"firstName"},{"active":true,"columnType":"column","alias":"firstProto","field":"app_proto","fieldName":"app_proto","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"app_proto","column":"firstProto","visualOptions":{"label":"Protocol","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":true,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"firstProto"},{"active":true,"columnType":"column","alias":"firstMagic","field":"file_magic","fieldName":"file_magic","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"file_magic","column":"firstMagic","visualOptions":{"label":"File Type","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":true,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"firstMagic"},{"active":true,"columnType":"column","alias":"firstSize","field":"file_size","fieldName":"file_size","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"file_size","column":"firstSize","visualOptions":{"label":"Size","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"firstSize"},{"active":true,"columnType":"bucket","alias":"file_sha256","field":"file_sha256","fieldName":"file_sha256","useFn":false,"isSavedField":false,"aggregation":"terms","fn":{},"bucket":"file_sha256","preFn":"file_sha256","filterFn":{"custom":false},"isStringFieldType":true,"isNumberFieldType":false,"isCollectionFieldType":false,"unwindCollection":false,"autoBucket":true,"interval":"5m","visualOptions":{"label":"SHA256","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"file_sha256"},{"active":true,"columnType":"bucket","alias":"file_md5","field":"file_md5","fieldName":"file_md5","useFn":false,"isSavedField":false,"aggregation":"terms","fn":{},"bucket":"file_md5","preFn":"file_md5","filterFn":{"custom":false},"isStringFieldType":true,"isNumberFieldType":false,"isCollectionFieldType":false,"unwindCollection":false,"autoBucket":true,"interval":"5m","visualOptions":{"label":"File MD5","showLabel":false,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"file_md5"},{"active":true,"columnType":"bucket","alias":"file_sha1","field":"file_sha1","fieldName":"file_sha1","useFn":false,"isSavedField":false,"aggregation":"terms","fn":{},"bucket":"file_sha1","preFn":"file_sha1","filterFn":{"custom":false},"isStringFieldType":true,"isNumberFieldType":false,"isCollectionFieldType":false,"unwindCollection":false,"autoBucket":true,"interval":"5m","visualOptions":{"label":"File SHA1","showLabel":false,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"file_sha1"},{"active":true,"columnType":"metric","metric":"file_sha256","alias":"countHash","useAggr":true,"metricName":"file_sha256","field":"file_sha256","fieldName":"count(file_sha256)","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countHash=count(file_sha256)","postAggr":""},"visualOptions":{"label":"Count","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"metricBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"countHash"}],"includeTotal":{"active":false,"hidden":false},"groupRowsByOrder":1,"type":"table","hideTooMuchData":{"active":true,"value":502,"message":"To protect the browser performance, a limit of output records has been imposed on the widget. Please apply filters or narrow down the analysed time frame to display the results."},"hideTooMuchInputData":{"active":false},"noData":{"active":false},"drilldown":[],"showLocalQuerySwitch":false,"globalFilter":true,"filterable":true,"sortable":true,"displayValuesOnXAxis":false,"rowGroupMode":null,"groupRowsBy":null}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"},"query":"","advanced":false},"outputQuery":{},"aggs":{"metrics":[{"metric":"file_name","field":"file_name","aggregation":"first","fn":{"aggr":"firstName=first(file_name)"},"alias":"firstName"},{"metric":"app_proto","field":"app_proto","aggregation":"first","fn":{"aggr":"firstProto=first(app_proto)"},"alias":"firstProto"},{"metric":"file_magic","field":"file_magic","aggregation":"first","fn":{"aggr":"firstMagic=first(file_magic)"},"alias":"firstMagic"},{"metric":"file_size","field":"file_size","aggregation":"first","fn":{"aggr":"firstSize=first(file_size)"},"alias":"firstSize"},{"metric":"file_sha256","metricName":"file_sha256","useAggr":true,"field":"file_sha256","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countHash=count(file_sha256)","postAggr":""},"alias":"countHash","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true}],"buckets":[{"aggregation":"terms","useFn":false,"bucket":"file_sha256","field":"file_sha256","alias":"file_sha256","preFn":"file_sha256","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true},{"aggregation":"terms","useFn":false,"bucket":"file_md5","field":"file_md5","alias":"file_md5","preFn":"file_md5","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true},{"aggregation":"terms","useFn":false,"bucket":"file_sha1","field":"file_sha1","alias":"file_sha1","preFn":"file_sha1","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true}]},"sorters":[{"field":"countHash","direction":"desc","description":"count(file_sha256) (desc)"}],"limit":{"active":true,"limit":50,"from":"head","othersShow":false},"queries":[{"nql":"aggr firstName=first(file_name), firstProto=first(app_proto), firstMagic=first(file_magic), firstSize=first(file_size), countHash=count(file_sha256) by file_sha256 as file_sha256, file_md5 as file_md5, file_sha1 as file_sha1 unwind=true | sort countHash desc | limit 50","subpipes":[]}],"columns":[{"active":true,"columnType":"column","alias":"firstName","field":"file_name","fieldName":"file_name","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"file_name","column":"firstName","visualOptions":{"label":"File Name","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":true,"defaultColWidth":150,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"firstName","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"column","alias":"firstProto","field":"app_proto","fieldName":"app_proto","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"app_proto","column":"firstProto","visualOptions":{"label":"Protocol","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":true,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"firstProto","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"column","alias":"firstMagic","field":"file_magic","fieldName":"file_magic","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"file_magic","column":"firstMagic","visualOptions":{"label":"File Type","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":true,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"firstMagic","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"column","alias":"firstSize","field":"file_size","fieldName":"file_size","fieldType":"field","useFn":false,"isSavedField":false,"fn":{},"preFn":"file_size","column":"firstSize","visualOptions":{"label":"Size","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"firstSize","isStringFieldType":false,"isCollectionFieldType":false,"isNumberFieldType":true},{"active":true,"columnType":"bucket","alias":"file_sha256","field":"file_sha256","fieldName":"file_sha256","useFn":false,"isSavedField":false,"aggregation":"terms","fn":{},"bucket":"file_sha256","preFn":"file_sha256","filterFn":{"custom":false},"isStringFieldType":true,"isNumberFieldType":false,"isCollectionFieldType":false,"unwindCollection":false,"autoBucket":true,"interval":"5m","visualOptions":{"label":"SHA256","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"file_sha256"},{"active":true,"columnType":"bucket","alias":"file_md5","field":"file_md5","fieldName":"file_md5","useFn":false,"isSavedField":false,"aggregation":"terms","fn":{},"bucket":"file_md5","preFn":"file_md5","filterFn":{"custom":false},"isStringFieldType":true,"isNumberFieldType":false,"isCollectionFieldType":false,"unwindCollection":false,"autoBucket":true,"interval":"5m","visualOptions":{"label":"File MD5","showLabel":false,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"file_md5"},{"active":true,"columnType":"bucket","alias":"file_sha1","field":"file_sha1","fieldName":"file_sha1","useFn":false,"isSavedField":false,"aggregation":"terms","fn":{},"bucket":"file_sha1","preFn":"file_sha1","filterFn":{"custom":false},"isStringFieldType":true,"isNumberFieldType":false,"isCollectionFieldType":false,"unwindCollection":false,"autoBucket":true,"interval":"5m","visualOptions":{"label":"File SHA1","showLabel":false,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"file_sha1"},{"active":true,"columnType":"metric","metric":"file_sha256","alias":"countHash","useAggr":true,"metricName":"file_sha256","field":"file_sha256","fieldName":"count(file_sha256)","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countHash=count(file_sha256)","postAggr":""},"visualOptions":{"label":"Count","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"metricBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"countHash","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false}],"includeTotal":{"active":false,"hidden":false}},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136cda-d89d1b5f-28fdba23","permissions":{"entityId":"67136cda-d89d1b5f-28fdba23","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}},"style":{"padding":{"top":0,"bottom":0,"left":0,"right":0}}},{"layout":{"id":"a1b2c3d4-9999-4aaa-bbbb-000000000009","header":null,"w":10,"h":6,"x":14,"y":12,"moved":false,"static":false},"config":{"$ref":"67136cda-d89d1b5f-28fdba27","id":"67136cda-d89d1b5f-28fdba27","name":"Suricata - Top File Types Detail","type":"visualization","tags":[],"createdBy":"admin","modifiedBy":"admin","created":1770830129684,"modified":1770830129684,"visualizationConfig":{"type":"table","concreteVisualizationConfig":{"dataKey":"countMagic","dataKeys":["countMagic","uniqueFiles","uniqueHashes"],"categoryKey":"file_magic","categoryKeys":["file_magic"],"formatting":{"metrics":[{"formattingType":"off"},{"formattingType":"off"},{"formattingType":"off"}],"buckets":[{"formattingType":"off"}]},"names":{"metrics":[{"custom":false,"value":"count(file_magic)"},{"custom":false,"value":"dc(file_name)"},{"custom":false,"value":"dc(file_sha256)"}],"buckets":[{"custom":true,"value":"File Type"}]},"colors":{"metrics":[{"useDefaultColor":true},{"useDefaultColor":true},{"useDefaultColor":true}]},"thresholds":{"metrics":[null,null,null]},"areThresholdsAbsolute":{"metrics":[null,null,null]},"baselines":[],"baselineMetrics":{},"baselineKeys":[],"defaultFilterStream":["suricata"],"columns":[{"active":true,"columnType":"bucket","alias":"file_magic","aggregation":"terms","field":"file_magic","fieldName":"file_magic","useFn":false,"isSavedField":false,"fn":{},"bucket":"file_magic","preFn":"file_magic","filterFn":{"custom":false},"isStringFieldType":true,"isNumberFieldType":false,"isCollectionFieldType":false,"unwindCollection":false,"autoBucket":true,"interval":"5m","visualOptions":{"label":"File Type","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":true,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"file_magic"},{"active":true,"columnType":"metric","metric":"file_magic","alias":"countMagic","aggregation":"count","useAggr":true,"metricName":"file_magic","field":"file_magic","fieldName":"count(file_magic)","fieldType":"field","aggrParams":{},"fn":{"aggr":"countMagic=count(file_magic)","postAggr":""},"visualOptions":{"label":"Count","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"metricBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"countMagic","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"metric","metric":"file_name","alias":"uniqueFiles","aggregation":"dc","useAggr":true,"metricName":"file_name","field":"file_name","fieldName":"dc(file_name)","fieldType":"field","aggrParams":{},"fn":{"aggr":"uniqueFiles=dc(file_name)","postAggr":""},"visualOptions":{"label":"Unique Files","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"metricBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"uniqueFiles","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"metric","metric":"file_sha256","alias":"uniqueHashes","aggregation":"dc","useAggr":true,"metricName":"file_sha256","field":"file_sha256","fieldName":"dc(file_sha256)","fieldType":"field","aggrParams":{},"fn":{"aggr":"uniqueHashes=dc(file_sha256)","postAggr":""},"visualOptions":{"label":"Unique Hashes","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"metricBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"uniqueHashes","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false}],"includeTotal":{"active":false,"hidden":false},"groupRowsByOrder":1,"type":"table","hideTooMuchData":{"active":true,"value":502,"message":"To protect the browser performance, a limit of output records has been imposed on the widget. Please apply filters or narrow down the analysed time frame to display the results."},"hideTooMuchInputData":{"active":false},"noData":{"active":false},"drilldown":[],"showLocalQuerySwitch":false,"globalFilter":true,"filterable":true,"sortable":true,"displayValuesOnXAxis":false,"rowGroupMode":null,"groupRowsBy":null}},"data":{"dataMode":"advanced","source":{"name":"suricata","type":"stream","isRaw":true,"base":"suricata","resolution":""},"query":{"timerange":{"from":"now-24hours","to":"now","roundTo":"hour"},"query":"","advanced":false},"outputQuery":{},"aggs":{"metrics":[{"metric":"file_magic","metricName":"file_magic","useAggr":true,"field":"file_magic","fieldType":"field","aggregation":"count","aggrParams":{},"fn":{"aggr":"countMagic=count(file_magic)","postAggr":""},"alias":"countMagic","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true},{"metric":"file_name","metricName":"file_name","useAggr":true,"field":"file_name","fieldType":"field","aggregation":"dc","aggrParams":{},"fn":{"aggr":"uniqueFiles=dc(file_name)","postAggr":""},"alias":"uniqueFiles","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true},{"metric":"file_sha256","metricName":"file_sha256","useAggr":true,"field":"file_sha256","fieldType":"field","aggregation":"dc","aggrParams":{},"fn":{"aggr":"uniqueHashes=dc(file_sha256)","postAggr":""},"alias":"uniqueHashes","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true}],"buckets":[{"aggregation":"terms","useFn":false,"bucket":"file_magic","field":"file_magic","alias":"file_magic","preFn":"file_magic","autoBucket":true,"interval":"5m","includeNullValues":true,"includeZeroValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"limit":{"active":false},"filterFn":{"custom":false},"unwindCollection":false,"isCollectionFieldType":false,"isNumberFieldType":false,"isStringFieldType":true}]},"sorters":[{"field":"countMagic","direction":"desc","description":"count(file_magic) (desc)"}],"limit":{"active":true,"limit":30,"from":"head","othersShow":false},"queries":[{"nql":"src event_type = \"fileinfo\" | aggr countMagic=count(file_magic), uniqueFiles=dc(file_name), uniqueHashes=dc(file_sha256) by file_magic as file_magic unwind=true | sort countMagic desc | limit 30","subpipes":[]}],"columns":[{"active":true,"columnType":"bucket","alias":"file_magic","aggregation":"terms","field":"file_magic","fieldName":"file_magic","useFn":false,"isSavedField":false,"fn":{},"bucket":"file_magic","preFn":"file_magic","filterFn":{"custom":false},"isStringFieldType":true,"isNumberFieldType":false,"isCollectionFieldType":false,"unwindCollection":false,"autoBucket":true,"interval":"5m","visualOptions":{"label":"File Type","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":true,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"countBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"file_magic"},{"active":true,"columnType":"metric","metric":"file_magic","alias":"countMagic","aggregation":"count","useAggr":true,"metricName":"file_magic","field":"file_magic","fieldName":"count(file_magic)","fieldType":"field","aggrParams":{},"fn":{"aggr":"countMagic=count(file_magic)","postAggr":""},"visualOptions":{"label":"Count","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"metricBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"countMagic","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"metric","metric":"file_name","alias":"uniqueFiles","aggregation":"dc","useAggr":true,"metricName":"file_name","field":"file_name","fieldName":"dc(file_name)","fieldType":"field","aggrParams":{},"fn":{"aggr":"uniqueFiles=dc(file_name)","postAggr":""},"visualOptions":{"label":"Unique Files","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"metricBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"uniqueFiles","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false},{"active":true,"columnType":"metric","metric":"file_sha256","alias":"uniqueHashes","aggregation":"dc","useAggr":true,"metricName":"file_sha256","field":"file_sha256","fieldName":"dc(file_sha256)","fieldType":"field","aggrParams":{},"fn":{"aggr":"uniqueHashes=dc(file_sha256)","postAggr":""},"visualOptions":{"label":"Unique Hashes","showLabel":true,"align":"left"},"formatting":{"formattingType":"off"},"defaultColAutoWidth":false,"backgroundColor":{"useCustomColor":false},"foregroundColor":{"useCustomColor":false},"metricBar":{"active":false},"includeNullValues":true,"includeEmptyValues":true,"includeEmptyListValues":true,"includeZeroValues":true,"limit":{"active":false},"showAddFilterButton":true,"defaultFilterStream":"suricata","dataField":"uniqueHashes","isStringFieldType":true,"isCollectionFieldType":false,"isNumberFieldType":false}],"includeTotal":{"active":false,"hidden":false}},"version":31,"options":{},"entitySet":"COMPONENT","entityType":"visualization","annotations":null,"_qbId":"67136cda-d89d1b5f-28fdba27","permissions":{"entityId":"67136cda-d89d1b5f-28fdba27","entityType":"COMPONENT.visualization","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true}}}],"version":5,"descriptionDefaultShow":true,"acl":{"permissions":[],"privacy":"public","publicPermissions":[],"entityId":"67136cda-d89d1b5f-28fdba2b","entityType":"COMPONENT.dashboard","owner":"admin","availPerms":["VIEW","EDIT","ADD","DELETE","EXECUTE","MODIFY_OWNERSHIP","GRANT_PERMISSIONS"],"isOwner":true,"aclEdit":true},"entitySet":"COMPONENT","entityType":"dashboard","annotations":null,"permissions":{"entityId":"67136cda-d89d1b5f-28fdba2b","entityType":"COMPONENT.dashboard","canAdd":true,"canView":true,"canEdit":true,"canDelete":true,"canExecute":true,"canModifyOwner":true,"canGrantPermissions":true},"aclEdit":true}